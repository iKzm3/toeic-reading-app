{% extends "layout.html" %}
{% block content %}
  <style>
    .p6-passage.sticky-top { top: 0; z-index: 1020; background: var(--bs-body-bg,#fff); padding-top:.5rem; padding-bottom:.5rem; }
    .p6-scroll { max-height: 50vh; overflow: auto; }
    @media (min-height: 800px){ .p6-scroll{ max-height: 60vh; } }
    .p6-choice-btn { white-space: normal; }
  </style>
  <div class="card shadow-sm">
    <div class="card-body">
      <div class="d-flex justify-content-between align-items-center mb-3">
        <h1 class="h5 m-0">Part 6（本文穴埋め）</h1>
        <div class="d-flex gap-2 align-items-center">
          <a href="{{ url_for('index') }}" class="btn btn-outline-secondary btn-sm">🏠 トップ</a>
          <div id="statsBox" class="text-muted small me-2">0/0 正答率 0%</div>
          <button id="settingsBtn" class="btn btn-outline-secondary btn-sm">⚙️ 設定</button>
          <button id="resetStatsBtn" class="btn btn-outline-danger btn-sm">成績リセット</button>
          <button id="reviewToggle" class="btn btn-outline-warning btn-sm" aria-pressed="false" autocomplete="off">復習モード: OFF</button>
          <button id="nextBtn" class="btn btn-outline-secondary btn-sm">次の文書</button>
        </div>
      </div>
      <div class="p6-passage sticky-top"><div id="passageBox" class="mb-3"></div></div>
      <div class="p6-scroll"><div id="groupsBox" class="mb-3"></div></div>
      <div class="d-flex gap-2">
        <button id="submitBtn" class="btn btn-primary">解答を送信</button>
        <div id="result" class="alert mt-2 d-none flex-grow-1" role="alert"></div>
      </div>
      <details class="mt-3" id="explainPanel">
        <summary>解説</summary>
        <div id="explain" class="mt-2"></div>
        <hr>
        <div id="jaBox" class="mt-2"></div>
        <div id="vocabBox" class="mt-2"></div>
      </details>
    </div>
  </div>
{% endblock %}
{% block scripts %}
<script src="/static/main6.js?v=8"></script>
<script>window.addEventListener('DOMContentLoaded', () => { window.Part6Trainer.load(); });</script>
{% endblock %}